<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <meta name="description" content="Men√∫ Capibobba - Tu dosis diaria de felicidad y sabor. Frapp√©s base agua y leche, bebidas calientes, especialidades como chamoyadas y yogurtadas. ¬°Ordena por WhatsApp!">
    <meta name="keywords" content="capibobba, frapp√©, bubble tea, bebidas, chamoyada, yogurtada, toppings, bebidas fr√≠as, bebidas calientes, men√∫">
    <meta name="author" content="Capibobba">
    <meta name="robots" content="index, follow">

    <!-- Verificaci√≥n del sitio para desarrolladores de TikTok -->
    <meta name="tiktok-developers-site-verification" content="w9wWFGED1UxKws8NAjjF0ndnoNuWKKGH" />

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="MEN√ö CAPIBOBBA - Tu dosis diaria de felicidad y sabor">
    <meta property="og:description" content="Descubre nuestro delicioso men√∫ de frapp√©s, bubble tea, bebidas calientes y especialidades √∫nicas. ¬°Ordena por WhatsApp y disfruta!">
    <meta property="og:image" content="https://i.imgur.com/llR0NN0.png">
    <meta property="og:url" content="https://feyomx.github.io/menucapibobba/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Capibobba">
    <meta property="og:locale" content="es_MX">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="MEN√ö CAPIBOBBA - Tu dosis diaria de felicidad y sabor">
    <meta name="twitter:description" content="Descubre nuestro delicioso men√∫ de frapp√©s, bubble tea, bebidas calientes y especialidades √∫nicas. ¬°Ordena por WhatsApp!">
    <meta name="twitter:image" content="https://i.imgur.com/llR0NN0.png">
    <meta name="twitter:site" content="@capibobba">
    <!-- A√±adir un icono para la pesta√±a del navegador -->
    <link rel="icon" type="image/png" href="https://i.imgur.com/llR0NN0.png">
    <link rel="manifest" href="manifest.json">

    <!-- DNS prefetch para dominios externos -->
    <link rel="dns-prefetch" href="https://i.imgur.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">

    <!-- Preconnect para recursos cr√≠ticos -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <title>MEN√ö CAPIBOBBA</title>
    
    <!-- CSS cr√≠tico inline para above-the-fold content -->
    <style>
        /* CSS cr√≠tico para evitar FOUC */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(180deg, #FFE1E6 0%, #F3E8FF 25%, #E0F2FE 50%, #FFF9E6 75%, #FFE1E6 100%);
            max-width: 1080px; margin: 0 auto; color: #343A40; line-height: 1.6;
        }
        .menu-header { text-align: center; padding: 2rem 1rem; }
        .menu-title { font-size: 2.5rem; margin: 1rem 0; }
        .loading-message { text-align: center; padding: 2rem; color: #666; }
    </style>

    <!-- CSS principal cargado de forma s√≠ncrona para evitar FOUC -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google Fonts optimizadas -->

    <!-- Google Fonts: Precarga cr√≠tica con display=swap para evitar FOIT -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:wght@700&family=Nunito:wght@400;600;700;800;900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:wght@700&family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet"></noscript>

    <!-- Font Awesome para iconos - Preload para evitar render blocking -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer"></noscript>

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Restaurant",
      "name": "Capibobba",
      "description": "Tu dosis diaria de felicidad y sabor. Especialistas en frapp√©s, bubble tea, bebidas calientes y especialidades √∫nicas.",
      "url": "https://feyomx.github.io/menucapibobba/",
      "logo": "https://i.imgur.com/llR0NN0.png",
      "image": "https://i.imgur.com/llR0NN0.png",
      "telephone": "+52-771-183-1526",
      "email": "capibobba@gmail.com",
      "servesCuisine": "Bebidas",
      "priceRange": "$",
      "openingHours": [
        "Mo-Fr 18:00-22:00",
        "Sa-Su 12:00-22:00"
      ],
      "sameAs": [
        "https://www.facebook.com/share/1C1ciA6mn6/",
        "https://www.instagram.com/capibobba",
        "https://vm.tiktok.com/ZSHgd5FEJ4Fdo-l8jb9/"
      ],
      "hasMenu": {
        "@type": "Menu",
        "name": "Men√∫ Capibobba",
        "description": "Frapp√©s base agua y leche, bebidas calientes, especialidades y toppings"
      }
    }
    </script>

    <!-- Google Analytics optimizado para velocidad -->
    <script>
      // Gtag optimizado y diferido
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-2YW39XNM9K', {
        page_title: 'Men√∫ Capibobba',
        page_location: window.location.href
      });

      // Cargar gtag de forma diferida
      setTimeout(() => {
        const script = document.createElement('script');
        script.async = true;
        script.src = 'https://www.googletagmanager.com/gtag/js?id=G-2YW39XNM9K';
        document.head.appendChild(script);
      }, 3000);
    </script>
    
</head>
<body>
    <!-- Burbujas de fondo animadas (elementos puramente decorativos) -->
    <div class="bubbles-background" aria-hidden="true">
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
    </div>

    <!-- Contenedor principal de decoraciones kawaii flotantes -->
    <!--<div class="kawaii-decorations-wrapper" aria-hidden="true">
     <!--   <!-- A√±adido onerror para ocultar la imagen si no carga -->
      <!--  <img src="https://i.imgur.com/llR0NN0.png" alt="Capibobba Flotante" class="kawaii-deco capibobba-deco" onerror="this.style.display='none';">
      <!--  <img src="https://i.imgur.com/8X1X3YJ.png" alt="Burbuja de t√© flotante" class="kawaii-deco bubble-tea-deco" onerror="this.style.display='none';">
     <!--   <img src="https://i.imgur.com/R0yFvRj.png" alt="Coraz√≥n flotante" class="kawaii-deco heart-deco" onerror="this.style.display='none';">
    </div>

    <!-- Header del men√∫ -->
    <header class="menu-header">
        <div class="logo-container">
            <!-- A√±adido onerror para ocultar la imagen si no carga -->
            <img src="https://i.imgur.com/g1iRrOw.png" alt="Logo Capibobba - Men√∫ de bebidas y frapp√©s" class="logo-light" id="logoLight" loading="eager" decoding="async" onerror="this.style.display='none';">
            <img src="https://i.imgur.com/llR0NN0.png" alt="Logo Capibobba versi√≥n oscura - Men√∫ de bebidas y frapp√©s" class="logo-dark" id="logoDark" loading="lazy" decoding="async" onerror="this.style.display='none';">
        </div>
        <h1 class="menu-title">MEN√ö <span class="title-part-1">CAPI</span><span class="title-part-2">BOBBA</span></h1>
        <p class="menu-subtitle">¬°Tu dosis diaria de felicidad y sabor!</p>
    </header>

    <!-- Contenedor principal del men√∫ -->
    <main class="menu-container">
        <!-- Secci√≥n de Frapp√©s Base Agua -->
        <section class="menu-section animate-on-scroll" data-animation="fade-in-up">
            <header class="section-header">
                <h2 class="section-title">Frapp√©s Base Agua üíß</h2>
                <p class="section-description">Refrescantes y llenos de sabor frutal.</p>
            </header>
            <div id="waterFrappesGrid" class="products-grid">
                <!-- Los frapp√©s base agua se cargar√°n aqu√≠ din√°micamente por JS -->
                <p class="loading-message">Cargando frapp√©s base agua...</p>
            </div>
        </section>

        <!-- Secci√≥n de Frapp√©s Base Leche -->
        <section class="menu-section animate-on-scroll" data-animation="fade-in-up">
            <header class="section-header">
                <h2 class="section-title">Frapp√©s Base Leche ü•õ</h2>
                <p class="section-description">Cremosos y deliciosos, perfectos para consentirte.</p>
            </header>
            <div id="milkFrappesGrid" class="products-grid">
                <!-- Los frapp√©s base leche se cargar√°n aqu√≠ din√°micamente por JS -->
                <p class="loading-message">Cargando frapp√©s base leche...</p>
            </div>
        </section>

        <!-- Secci√≥n de Bebidas Calientes -->
        <section class="menu-section animate-on-scroll" data-animation="fade-in-up">
            <header class="section-header">
                <h2 class="section-title">Bebidas Calientes ‚òï</h2>
                <p class="section-description">Para esos d√≠as que necesitas un abrazo c√°lido.</p>
            </header>
            <div id="hotDrinksGrid" class="products-grid">
                <!-- Las bebidas calientes se cargar√°n aqu√≠ din√°micamente por JS -->
                <p class="loading-message">Cargando bebidas calientes...</p>
            </div>
        </section>

        <!-- Secci√≥n de Especialidades -->
        <section class="menu-section promotions-section animate-on-scroll" data-animation="fade-in-up">
            <header class="section-header">
                <h2 class="section-title">‚ú® Especialidades ‚ú®</h2>
                <p class="section-description">¬°Nuestras creaciones √∫nicas y deliciosas!</p>
            </header>
            <div id="specialtiesGrid" class="promotions-grid">
                <!-- Las especialidades (Chamoyada, Yogurtada) se cargar√°n aqu√≠ -->
                <p class="loading-message">Cargando especialidades...</p>
            </div>
        </section>

        <!-- NUEVA Secci√≥n de Promociones -->
        <section class="menu-section promotions-section animate-on-scroll" data-animation="fade-in-up">
            <header class="section-header">
                <h2 class="section-title">‚ú® Promociones ‚ú®</h2>
                <p class="section-description">¬°No te pierdas nuestras ofertas y descuentos especiales!</p>
            </header>
            <div id="promotionsGrid" class="promotions-grid">
                <!-- Las promociones (descuentos, etc.) se cargar√°n aqu√≠ -->
                <p class="loading-message">Cargando promociones...</p>
            </div>
        </section>

        <!-- Secci√≥n de Toppings -->
        <section class="menu-section animate-on-scroll" data-animation="fade-in-up">
            <header class="section-header">
                <h2 class="section-title">Toppings Extra üç°</h2>
                <p class="section-description">¬°A√±ade un toque extra de diversi√≥n a tu bebida!</p>
            </header>
            <div id="toppingsGrid" class="products-grid toppings-grid">
                <!-- Los toppings se cargar√°n aqu√≠ din√°micamente por JS -->
                <p class="loading-message">Cargando toppings...</p>
            </div>
        </section>

        <!-- Secci√≥n C√ìMO ORDENAR -->
        <section class="menu-section order-section animate-on-scroll" data-animation="fade-in-up">
            <header class="section-header">
                <h2 class="section-title">¬øC√≥mo Ordenar? üìù</h2>
                <p class="section-description">Es f√°cil y r√°pido, ¬°pide por WhatsApp!</p>
            </header>
            <div class="order-steps">
                <div class="step">
                    <span class="step-number">1</span>
                    <h3>Elige tus Favoritos</h3>
                    <p>Explora nuestro men√∫ y selecciona las bebidas y toppings que m√°s te gusten.</p>
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <h3>A√±ade al Carrito</h3>
                    <p>Usa el bot√≥n "A√±adir al Carrito" en cada producto.</p>
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <h3>Env√≠a tu Pedido</h3>
                    <p>Haz clic en el bot√≥n de WhatsApp para enviarnos tu pedido. ¬°As√≠ de f√°cil!</p>
                </div>
            </div>
            <div class="social-links">
                <a href="#" id="whatsappOrderBtn" class="whatsapp-button" aria-label="Ordenar por WhatsApp">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="Icono de WhatsApp para realizar pedidos">
                    Ordenar por WhatsApp
                </a>
                <a href="https://www.facebook.com/share/1C1ciA6mn6/" target="_blank" rel="noopener noreferrer" class="facebook-link" aria-label="Visita nuestra p√°gina de Facebook">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b8/2021_Facebook_icon.svg" alt="Icono de Facebook - S√≠guenos en redes sociales">
                    S√≠guenos en Facebook
                </a>
            </div>
        </section>
    </main>

    <!-- Footer del men√∫ -->
    <footer class="menu-footer" id="footer">
        <div class="footer-content">
            <div class="footer-section about">
                <h3 class="footer-logo-text"><span>Capi</span>bobba</h3>
                <p>
                    Tu dosis diaria de felicidad y sabor. ¬°Te esperamos con una sonrisa y un vaso lleno de felicidad! üíñüåü.
                </p>
                <div class="contact">
                    <span><i class="fas fa-phone"></i> &nbsp; 771-183-1526</span>
                    <span><i class="fas fa-envelope"></i> &nbsp; capibobba@gmail.com</span>
                </div>
                <div class="socials">
                    <a href="https://www.facebook.com/share/1C1ciA6mn6/" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="https://www.instagram.com/capibobba?igsh=MWxjM2psMW1xM3IzYg==" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="https://vm.tiktok.com/ZSHgd5FEJ4Fdo-l8jb9/" target="_blank" rel="noopener noreferrer" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>
    
            <div class="footer-section links">
                <h3>Enlaces R√°pidos</h3>
                <ul>
                    <li><a href="#waterFrappesGrid">Frapp√©s Agua</a></li>
                    <li><a href="#milkFrappesGrid">Frapp√©s Leche</a></li>
                    <li><a href="#hotDrinksGrid">Bebidas Calientes</a></li>
                    <li><a href="#specialtiesGrid">Especialidades</a></li>
                    <li><a href="#promotionsGrid">Promociones</a></li>
                </ul>
            </div>
    
            <div class="footer-section hours">
                <h3>Horario de Atenci√≥n</h3>
                <p>Lunes - Viernes: 6:00 PM - 10:00 PM</p>
                <p>S√°bado - Domingo: 12:00 PM - 10:00 PM</p>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2025 Capibobba | Todos los derechos reservados | Hecho con üíñ y burbujas.
        </div>
    </footer>

    <!-- Carrito de compras flotante -->
    <div id="cartButton" class="cart-button" role="button" aria-label="Ver carrito de compras" tabindex="0">
        üõí <span id="cartItemCount" class="cart-item-count">0</span>
    </div>

    <!-- Modal del Carrito de Compras -->
    <div id="cartModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="cartModalTitle">
        <div class="modal-content cart-modal-content">
            <button class="close-modal-button" aria-label="Cerrar carrito">‚úñ</button>
            <h2 id="cartModalTitle" class="modal-title">Tu Carrito üõí</h2>
            <div id="cartItems" class="cart-items">
                <!-- Los √≠tems del carrito se cargar√°n aqu√≠ -->
                <p class="empty-cart-message">Tu carrito est√° vac√≠o.</p>
            </div>
            <div class="cart-summary">
                <p>Total: <span id="cartTotal">$0.00</span></p>
            </div>
            <div class="cart-actions">
                <button id="clearCartBtn" class="clear-cart-btn" aria-label="Vaciar carrito">Vaciar Carrito üóëÔ∏è</button>
                <a id="checkoutBtn" class="checkout-btn" href="#" target="_blank" rel="noopener noreferrer" aria-label="Proceder al pago">Ordenar por WhatsApp ‚úÖ</a>
            </div>
        </div>
    </div>

    <!-- Modal de Visualizaci√≥n de Imagen de Sabor -->
    <div id="flavorImageModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="flavorImageTitle">
        <div class="modal-content flavor-image-content">
            <button class="close-modal-button" aria-label="Cerrar vista de imagen">‚úñ</button>
            <h3 id="flavorImageTitle"></h3>
            <img id="flavorImageDisplay" src="" alt="Imagen de Sabor" class="flavor-image-display">
        </div>
    </div>

    <!-- Modal de Selecci√≥n de Toppings -->
    <div id="toppingSelectionModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="toppingModalTitle">
        <div class="modal-content topping-modal-content">
            <button class="close-modal-button" aria-label="Cerrar selecci√≥n de toppings">‚úñ</button>
            <h3 id="toppingModalTitle" class="modal-title">A√±adir Toppings a <span id="toppingModalProductName"></span></h3>
            <div id="availableToppingsGrid" class="toppings-modal-grid">
                <!-- Los toppings disponibles se cargar√°n aqu√≠ din√°micamente -->
            </div>
            <div class="topping-modal-actions">
                <button id="confirmToppingsButton" aria-label="Confirmar toppings">Confirmar Toppings ‚úÖ</button>
                <button id="cancelToppingsButton" aria-label="Cancelar toppings">Cancelar ‚ùå</button>
            </div>
        </div>
    </div>

    <!-- NUEVO: Modal de Personalizaci√≥n de Chamoyada -->
    <div id="chamoyadaCustomizationOverlay" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="chamoyadaModalTitle">
        <div class="modal-content chamoyada-modal-content">
            <header class="section-header">
                <h2 id="chamoyadaModalTitle" class="section-title">¬°Personaliza tu Chamoyada!</h2>
                <p class="section-description">Elige tu sabor base y a√±ade toppings.</p>
            </header>

            <div class="chamoyada-flavor-selection">
                <h3 class="flavor-selection-title">Escoge tu sabor base (Base Agua)</h3>
                <div id="chamoyadaBaseFlavorGrid" class="flavor-grid-small">
                    <!-- Los sabores base agua se cargar√°n aqu√≠ din√°micamente por JS -->
                </div>
            </div>

            <div class="chamoyada-topping-selection">
                <h3 class="topping-selection-title">A√±ade Toppings (Opcional)</h3>
                <div id="chamoyadaToppingsGrid" class="toppings-modal-grid">
                    <!-- Los toppings existentes se cargar√°n aqu√≠ din√°micamente por JS -->
                </div>
            </div>

            <div class="topping-modal-actions">
                <button id="confirmChamoyadaButton" aria-label="Confirmar Chamoyada">Confirmar Chamoyada ‚úÖ</button>
                <button id="cancelChamoyadaButton" aria-label="Cancelar Chamoyada">Cancelar ‚ùå</button>
            </div>
            <button class="close-modal-button" aria-label="Cerrar personalizaci√≥n de Chamoyada">‚úñ</button>
        </div>
    </div>
    <!-- FIN NUEVO: Modal de Personalizaci√≥n de Chamoyada -->

    <!-- NUEVO: Modal de Personalizaci√≥n de Yogurtada -->
    <div id="yogurtadaCustomizationOverlay" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="yogurtadaModalTitle">
        <div class="modal-content yogurtada-modal-content">
            <header class="section-header">
                <h2 id="yogurtadaModalTitle" class="section-title">¬°Personaliza tu Yogurtada!</h2>
                <p class="section-description">Elige tu sabor base y a√±ade toppings.</p>
            </header>

            <div class="yogurtada-flavor-selection">
                <h3 class="flavor-selection-title">Escoge tu sabor base (Base Frutal)</h3>
                <div id="yogurtadaBaseFlavorGrid" class="flavor-grid-small">
                    <!-- Los sabores base leche se cargar√°n aqu√≠ din√°micamente por JS -->
                </div>
            </div>

            <div class="yogurtada-topping-selection">
                <h3 class="topping-selection-title">A√±ade Toppings (Opcional)</h3>
                <div id="yogurtadaToppingsGrid" class="toppings-modal-grid">
                    <!-- Los toppings existentes se cargar√°n aqu√≠ din√°micamente por JS -->
                </div>
            </div>

            <div class="topping-modal-actions">
                <button id="confirmYogurtadaButton" aria-label="Confirmar Yogurtada">Confirmar Yogurtada ‚úÖ</button>
                <button id="cancelYogurtadaButton" aria-label="Cancelar Yogurtada">Cancelar ‚ùå</button>
            </div>
            <button class="close-modal-button" aria-label="Cerrar personalizaci√≥n de Yogurtada">‚úñ</button>
        </div>
    </div>
    <!-- FIN NUEVO: Modal de Personalizaci√≥n de Yogurtada -->

    <!-- Modal de Alerta Personalizado (Reemplaza alert()) -->
    <div id="customAlertModal" class="modal-overlay" role="alertdialog" aria-modal="true" aria-labelledby="customAlertTitle" aria-describedby="customAlertMessage">
        <div class="modal-content custom-alert-modal">
            <h3 id="customAlertTitle"></h3>
            <p id="customAlertMessage"></p>
            <button id="customAlertCloseBtn" class="checkout-btn">Aceptar</button>
        </div>
    </div>

    <!-- Plantillas para Renderizado Din√°mico -->
    <template id="productCardTemplate">
        <article class="product-card" tabindex="0" role="button">
            <div class="product-info">
                <h3 class="product-name"></h3>
                <p class="product-description"></p>
                <p class="product-price"></p>
            </div>
            <button class="add-to-cart-btn" aria-label="A√±adir al carrito">A√±adir ‚ûï</button>
        </article>
    </template>

    <template id="promotionCardTemplate">
        <article class="promotion-card" tabindex="0" role="button">
            <div class="promotion-info">
                <h3 class="promotion-name"></h3>
                <p class="promotion-description"></p>
                <p class="promotion-price"></p>
            </div>
            <button class="add-to-cart-btn" aria-label="A√±adir promoci√≥n al carrito">A√±adir ‚ûï</button>
        </article>
    </template>

    <!-- Preload del script principal -->
    <link rel="modulepreload" href="script.js">

    <!-- Carga de script.js como un M√ìDULO con defer -->
    <script src="script.js" type="module" defer></script>

    <!-- Carga de Firebase SDK y l√≥gica de inicializaci√≥n -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        // import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"; // Auth no es necesario para el men√∫ p√∫blico
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { firebaseConfig } from './firebase-config.js'; // Importar configuraci√≥n centralizada

        // Funci√≥n para mostrar el modal de alerta personalizado
        window.showCustomAlert = function(title, message) {
            document.getElementById('customAlertTitle').textContent = title;
            document.getElementById('customAlertMessage').textContent = message;
            if (window.openModal) window.openModal(document.getElementById('customAlertModal'));
        };

        // Event listener para cerrar el modal de alerta
        document.getElementById('customAlertCloseBtn').addEventListener('click', () => {
            if (window.closeModal) window.closeModal(document.getElementById('customAlertModal'));
        });

        // Inicializar Firebase y autenticar
        async function initializeFirebase() {
            // Validar que firebaseConfig no est√© vac√≠o
            if (!firebaseConfig.apiKey || !firebaseConfig.projectId) {
                console.error("Firebase config is incomplete. Please update firebaseConfig with your actual Firebase project details.");
                window.showCustomAlert('Error de Configuraci√≥n', 'La configuraci√≥n de Firebase est√° incompleta. Por favor, edita index.html y admin.html con los detalles de tu proyecto Firebase.');
                return;
            }

            try {
                const app = initializeApp(firebaseConfig);
                const db = getFirestore(app);
                // const auth = getAuth(app); // No se necesita autenticaci√≥n para leer el men√∫
                const appId = firebaseConfig.projectId; // Usamos projectId como appId para Firestore

                // --- L√ìGICA SIMPLIFICADA ---
                // Ya que las reglas de Firestore permiten la lectura p√∫blica de los datos del admin,
                // no necesitamos iniciar sesi√≥n. Esto evita conflictos con la sesi√≥n del admin en otra pesta√±a.
                
                // Define un identificador √∫nico para el men√∫. Este NO es una credencial.
                // Usaremos este ID para construir la ruta a los productos en Firestore.
                const menuId = 'menu-capibobba'; // Puedes usar el ID del proyecto o un nombre √∫nico.

                // Iniciar la l√≥gica del men√∫ directamente, sin autenticaci√≥n.
                if (typeof window.initMenu === 'function') {
                    window.initMenu(db, menuId, appId);
                } else {
                    console.error("Error: window.initMenu no es una funci√≥n. Aseg√∫rate de que script.js se cargue correctamente como un m√≥dulo.");
                    window.showCustomAlert('Error Interno', 'No se pudo iniciar el men√∫. Por favor, contacta a soporte.');
                }

            } catch (error) {
                console.error("Error al inicializar Firebase o autenticar en el men√∫:", error);
                window.showCustomAlert('Error de Conexi√≥n', 'No se pudo cargar el men√∫ din√°micamente. Por favor, int√©ntalo de nuevo m√°s tarde.');
            }
        }

        // Asegurarse de que el DOM est√© completamente cargado antes de inicializar Firebase
        document.addEventListener('DOMContentLoaded', initializeFirebase);
    </script>

    <!-- Registrar Service Worker para cache offline -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Detectar la base URL correcta para GitHub Pages
                const baseUrl = window.location.pathname.includes('/menucapibobba/')
                    ? '/menucapibobba/'
                    : '/';

                navigator.serviceWorker.register(baseUrl + 'sw.js', {
                    scope: baseUrl
                })
                    .then(registration => {
                        console.log('SW registrado exitosamente:', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW fall√≥:', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
